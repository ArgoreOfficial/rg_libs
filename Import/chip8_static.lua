local DISPLAY_WIDTH  = 64
local DISPLAY_HEIGHT = 32
local ctx = {}
local function clamp8(_value)  return bit32.band(_value, 0xFF) end
local function clamp16(_value) return bit32.band(_value, 0xFFFF) end

local function malloc(_size) 
	return 0 
end

local function get_ram(_byte) return ctx.RAM[_byte+1] end
local function set_ram(_byte, _value) ctx.RAM[_byte+1] = clamp8(_value) end

local function get_reg(_register) 
	return ctx.registers[_register+1] 
end

local function set_reg(_register, _value) 
	ctx.registers[_register+1] = clamp8(_value)
end

local function add_reg(_register, _value)
	ctx.registers[_register+1] = bit32.band((ctx.registers[_register+1] + _value), 0xFF)
end

local function create_buffer(_length, _varsize)
	local buf = {}
	for i = 1, _length do
		buf[#buf+1] = malloc(_varsize)
	end
	return buf
end

local function write_table_to_ram(_at, _table)
	for i = 1, #_table do
		ctx.RAM[_at + i] = clamp8(_table[ i ])
	end
end


-- 00E0
function CLS()
	for y = 1, 32 do
		for x = 1, 64 do
			ctx.display:SetPixel(x, y, color.black)
		end
	end
end

-- 2NNN
function CALL_NNN(_nnn)
	ctx.stack[ctx.SP] = ctx.PC
	ctx.SP = ctx.SP + 1
	ctx.PC = _nnn
end

-- 9XY0
function SNE_VX_VY(_vx, _vy)
	if get_reg(_vx) ~= get_reg(_vy) then ctx.PC = ctx.PC + 2 end
end

-- DXYN
function DRW_VX_VY_N(_vx, _vy, _n)
	local xcoord = get_reg(_vx) % DISPLAY_WIDTH
	local ycoord = get_reg(_vy) % DISPLAY_HEIGHT
	set_reg(0xF, 0)

	for row = 0, _n-1 do
		local bits = get_ram(clamp16(ctx.I + row))
		local cy = (ycoord + row) % DISPLAY_HEIGHT

		for col = 0, 7 do
			local cx = (xcoord + col) % DISPLAY_WIDTH
			local bit = bit32.extract(bits, 7 - col)
			
			if bit > 0 then 
				local v = ctx.display:GetPixel(cx+1, cy+1) == color.white 
				if v then 
					set_reg(0xF, 1) 
					ctx.display:SetPixel(cx+1, cy+1, color.black)
				else
					ctx.display:SetPixel(cx+1, cy+1, color.white)
				end
			end
		end
	end
end

-- FX__

local FX_ops = {
	[0x33] = function(_vx)
		local s = string.format("%03d", get_reg(_vx))
		set_ram(ctx.I, tonumber(s:sub(1,1)))
		set_ram(clamp16(ctx.I + 1), tonumber(s:sub(2,2)))
		set_ram(clamp16(ctx.I + 2), tonumber(s:sub(3,3)))
	end,
	
}

ctx.display = PixelData.new(DISPLAY_WIDTH, DISPLAY_HEIGHT, color.black)
ctx.RAM = create_buffer(4096)
ctx.registers = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } -- 16 8-bit registers
ctx.DT = 0 -- 8-bit
ctx.ST = 0 -- 8-bit
ctx.I  = 0 -- 16-bit
ctx.PC = 0x200 -- program counter, 16-bit
ctx.SP = 0 -- stack pointer, 8-bit
ctx.stack = {}
ctx.keys = {
    0,0,0,0,
    0,0,0,0,
    0,0,0,0,
    0,0,0,0
}

local program = {
    [512] = function() ctx.PC = clamp16(769); end,
    [514] = function() set_reg(0, get_reg(10)); end,
    [515] = function() ctx.I = 64; end,
    [516] = function() if get_reg(0) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [518] = function() ctx.PC = clamp16(2596); end,
    [519] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1150; end,
    [520] = function() add_reg(14,129); end,
    [521] = function() local vx = get_reg(1);set_reg(1, bit32.lshift(vx, 1));set_reg(0xF, (bit32.band(vx, 0x80) == 0) and 0 or 1); end,
    [522] = function() add_reg(14,128); end,
    [525] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1150; end,
    [526] = function() add_reg(14,129); end,
    [527] = function() local vx = get_reg(1);set_reg(1, bit32.lshift(vx, 1));set_reg(0xF, (bit32.band(vx, 0x80) == 0) and 0 or 1); end,
    [528] = function() add_reg(14,0); end,
    [531] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2140; end,
    [533] = function() if get_reg(10) == 20 then ctx.PC = ctx.PC + 2 end end,
    [534] = function() ctx.PC = clamp16(1024); end,
    [537] = function() local vx,vy = get_reg(2),get_reg(5);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [540] = function() ctx.PC = clamp16(1064); end,
    [541] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2128; end,
    [543] = function() ctx.I = 2625; end,
    [544] = function() if get_reg(1) ~= 130 then ctx.PC = ctx.PC + 2 end end,
    [545] = function() local vx,vy = get_reg(2),get_reg(5);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [547] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 584; end,
    [548] = function() if get_reg(8) ~= 18 then ctx.PC = ctx.PC + 2 end end,
    [549] = function() ctx.PC = clamp16(580); end,
    [550] = function() if get_reg(4) ~= 170 then ctx.PC = ctx.PC + 2 end end,
    [551] = function() ctx.I = 2625; end,
    [552] = function() if get_reg(1) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [554] = function() if get_reg(0) == 92 then ctx.PC = ctx.PC + 2 end end,
    [556] = function() if get_reg(15) == 15 then ctx.PC = ctx.PC + 2 end end,
    [572] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),247)); end,
    [574] = function() add_reg(14,31); end,
    [575] = function() ctx.PC = clamp16(3859); end,
    [576] = function() ctx.PC = clamp16(784); end,
    [577] = function() ctx.PC = clamp16(8); end,
    [579] = function() ctx.PC = clamp16(1888); end,
    [580] = function() set_reg(0,128); end,
    [581] = function() set_reg(0, get_reg(3)); end,
    [582] = function() if get_reg(0) == 96 then ctx.PC = ctx.PC + 2 end end,
    [583] = function() set_reg(0,31); end,
    [584] = function() ctx.PC = clamp16(3847); end,
    [591] = function() print('rand');set_reg(2, bit32.band(math.random(0, 255),130)); end,
    [592] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [600] = function() set_reg(2, bit32.band(get_reg(2), get_reg(8))); end,
    [601] = function() set_reg(2, bit32.band(get_reg(2), get_reg(0))); end,
    [605] = function() ctx.PC = clamp16(2052); end,
    [610] = function() ctx.PC = clamp16(3074); end,
    [614] = function() ctx.PC = clamp16(3135); end,
    [615] = function() if get_reg(15) == 72 then ctx.PC = ctx.PC + 2 end end,
    [616] = function() if get_reg(8) ~= 133 then ctx.PC = ctx.PC + 2 end end,
    [619] = function() local vx,vy = get_reg(10),get_reg(4);set_reg(10, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [620] = function() if get_reg(5) ~= 117 then ctx.PC = ctx.PC + 2 end end,
    [621] = function() add_reg(5,68); end,
    [622] = function() if get_reg(4) ~= 58 then ctx.PC = ctx.PC + 2 end end,
    [623] = function() if get_reg(10) == 35 then ctx.PC = ctx.PC + 2 end end,
    [624] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 797; end,
    [625] = function() ctx.PC = clamp16(3345); end,
    [626] = function() ctx.PC = clamp16(270); end,
    [628] = function() print('rand');set_reg(8, bit32.band(math.random(0, 255),40)); end,
    [629] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2303; end,
    [637] = function() set_reg(1, get_reg(8)); end,
    [638] = function() set_reg(0, get_reg(0)); end,
    [641] = function() ctx.I = 2240; end,
    [642] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),1)); end,
    [644] = function() ctx.PC = clamp16(3775); end,
    [645] = function() ctx.PC = clamp16(get_reg(0) + 3908); end,
    [646] = function() if get_reg(4) ~= 136 then ctx.PC = ctx.PC + 2 end end,
    [649] = function() local vx,vy = get_reg(8),get_reg(4);set_reg(8, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [650] = function() if get_reg(4) ~= 118 then ctx.PC = ctx.PC + 2 end end,
    [651] = function() add_reg(6,69); end,
    [652] = function() if get_reg(5) ~= 250 then ctx.PC = ctx.PC + 2 end end,
    [654] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 573; end,
    [655] = function() if get_reg(13) == 17 then ctx.PC = ctx.PC + 2 end end,
    [656] = function() ctx.PC = clamp16(270); end,
    [660] = function() set_reg(0, get_reg(7)); end,
    [661] = function() add_reg(0,78); end,
    [662] = function() if get_reg(14) ~= 37 then ctx.PC = ctx.PC + 2 end end,
    [663] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1317; end,
    [664] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1314; end,
    [665] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 576; end,
    [666] = function() if get_reg(0) ~= 162 then ctx.PC = ctx.PC + 2 end end,
    [667] = function() ctx.I = 533; end,
    [668] = function() ctx.PC = clamp16(1429); end,
    [670] = function() ctx.PC = clamp16(559); end,
    [671] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 4080; end,
    [674] = function() set_reg(0, get_reg(6)); end,
    [675] = function() set_reg(0,16); end,
    [676] = function() ctx.PC = clamp16(8); end,
    [678] = function() print('rand');set_reg(8, bit32.band(math.random(0, 255),56)); end,
    [679] = function() if get_reg(8) == 20 then ctx.PC = ctx.PC + 2 end end,
    [680] = function() ctx.PC = clamp16(1036); end,
    [682] = function() ctx.I = 1108; end,
    [684] = function() if get_reg(8) == get_reg(15) then ctx.PC = ctx.PC + 2 end end,
    [690] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [691] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [692] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [693] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [694] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [695] = function() if get_reg(0) == 48 then ctx.PC = ctx.PC + 2 end end,
    [696] = function() if get_reg(0) == 120 then ctx.PC = ctx.PC + 2 end end,
    [697] = function() add_reg(8,72); end,
    [698] = function() if get_reg(8) ~= 236 then ctx.PC = ctx.PC + 2 end end,
    [700] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),132)); end,
    [702] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),204)); end,
    [703] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),236)); end,
    [706] = function() DRW_VX_VY_N(12, 12, 12); end,
    [707] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),204)); end,
    [708] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),216)); end,
    [709] = function() DRW_VX_VY_N(8, 15, 0); end,
    [714] = function() DRW_VX_VY_N(8, 13, 8); end,
    [715] = function() DRW_VX_VY_N(8, 12, 0); end,
    [716] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),192)); end,
    [717] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),192)); end,
    [718] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),192)); end,
    [719] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),0)); end,
    [721] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),192)); end,
    [722] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),0)); end,
    [733] = function() ctx.PC = clamp16(3328); end,
    [735] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 3368; end,
    [736] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2104; end,
    [737] = function() if get_reg(8) == 29 then ctx.PC = ctx.PC + 2 end end,
    [738] = function() ctx.PC = clamp16(3328); end,
    [741] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2049; end,
    [747] = function() ctx.PC = clamp16(548); end,
    [748] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1078; end,
    [749] = function() if get_reg(6) == 72 then ctx.PC = ctx.PC + 2 end end,
    [750] = function() if get_reg(8) ~= 89 then ctx.PC = ctx.PC + 2 end end,
    [752] = function() set_reg(10,123); end,
    [753] = function() add_reg(11,138); end,
    [756] = function() ctx.I = 2229; end,
    [757] = function() ctx.PC = clamp16(get_reg(0) + 1473); end,
    [758] = function() print('rand');set_reg(1, bit32.band(math.random(0, 255),205)); end,
    [759] = function() print('rand');set_reg(13, bit32.band(math.random(0, 255),215)); end,
    [760] = function() DRW_VX_VY_N(7, 14, 1); end,
    [769] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1301; end,
    [770] = function() ctx.PC = clamp16(1280); end,
    [771] = function() CLS(); end,
    [773] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1429; end,
    [775] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),8)); end,
    [777] = function() add_reg(12,252); end,
    [779] = function() add_reg(12,8); end,
    [781] = function() set_reg(2, get_reg(12)); end,
    [782] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),130)); end,
    [783] = function() local vx,vy = get_reg(2),get_reg(4);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [784] = function() if get_reg(4) ~= 129 then ctx.PC = ctx.PC + 2 end end,
    [785] = function() set_reg(1, get_reg(2)); end,
    [786] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 131; end,
    [787] = function() set_reg(3, get_reg(6)); end,
    [788] = function() set_reg(0,98); end,
    [789] = function() set_reg(2,0); end,
    [791] = function() set_reg(13,0); end,
    [793] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [795] = function() ctx.PC = clamp16(821); end,
    [796] = function() if get_reg(5) == 130 then ctx.PC = ctx.PC + 2 end end,
    [797] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [798] = function() ctx.PC = clamp16(1103); end,
    [799] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [801] = function() add_reg(2,76); end,
    [802] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [803] = function() add_reg(3,255); end,
    [805] = function() set_reg(14,180); end,
    [806] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [807] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [808] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [809] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [811] = function() ctx.PC = clamp16(819); end,
    [812] = function() if get_reg(3) == 96 then ctx.PC = ctx.PC + 2 end end,
    [813] = function() set_reg(0,180); end,
    [814] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [815] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [817] = function() ctx.PC = clamp16(805); end,
    [818] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1299; end,
    [819] = function() ctx.PC = clamp16(793); end,
    [820] = function() ctx.PC = clamp16(2414); end,
    [821] = function() set_reg(14,90); end,
    [823] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [824] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [825] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [827] = function() ctx.PC = clamp16(833); end,
    [828] = function() if get_reg(1) ~= 96 then ctx.PC = ctx.PC + 2 end end,
    [829] = function() set_reg(0,180); end,
    [830] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [831] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [833] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [834] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [835] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [837] = function() ctx.I = 746; end,
    [839] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [840] = function() ctx.PC = clamp16(3824); end,
    [841] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [842] = function() set_reg(5,98); end,
    [843] = function() set_reg(2,0); end,
    [845] = function() set_reg(3, get_reg(5)); end,
    [847] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [849] = function() local vx,vy = get_reg(13),get_reg(15);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [851] = function() add_reg(3,255); end,
    [853] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [855] = function() ctx.PC = clamp16(859); end,
    [857] = function() ctx.PC = clamp16(847); end,
    [858] = function() if get_reg(15) ~= 96 then ctx.PC = ctx.PC + 2 end end,
    [859] = function() set_reg(0,29); end,
    [860] = function() ctx.PC = clamp16(3456); end,
    [861] = function() local vx,vy = get_reg(0),get_reg(5);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [863] = function() local vx,vy = get_reg(13),get_reg(0);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [865] = function() set_reg(0, get_reg(12)); end,
    [866] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),129)); end,
    [867] = function() set_reg(1, get_reg(13)); end,
    [868] = function() DRW_VX_VY_N(0, 10, 2); end,
    [869] = function() ctx.I = 732; end,
    [870] = function() DRW_VX_VY_N(12, 15, 1); end,
    [871] = function() for i=0, 1 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [873] = function() add_reg(12,252); end,
    [875] = function() add_reg(13,2); end,
    [877] = function() set_reg(8, get_reg(12)); end,
    [878] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),136)); end,
    [879] = function() local vx,vy = get_reg(8),get_reg(4);set_reg(8, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [880] = function() if get_reg(4) ~= 105 then ctx.PC = ctx.PC + 2 end end,
    [881] = function() set_reg(9,0); end,
    [883] = function() ctx.I = 514; end,
    [885] = function() set_reg(1, get_reg(8)); end,
    [886] = function() set_reg(0, bit32.bxor(get_reg(0), get_reg(8))); end,
    [887] = function() set_reg(3, get_reg(6)); end,
    [888] = function() set_reg(0,98); end,
    [889] = function() set_reg(2,0); end,
    [891] = function() set_reg(7,0); end,
    [893] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [895] = function() ctx.PC = clamp16(921); end,
    [897] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [898] = function() ctx.PC = clamp16(1103); end,
    [899] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [901] = function() add_reg(2,76); end,
    [902] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [903] = function() add_reg(3,255); end,
    [905] = function() set_reg(14,180); end,
    [906] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [907] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [908] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [909] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [911] = function() ctx.PC = clamp16(919); end,
    [912] = function() if get_reg(7) ~= get_reg(6) then ctx.PC = ctx.PC + 2 end end,
    [913] = function() set_reg(0,180); end,
    [914] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [915] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [917] = function() ctx.PC = clamp16(905); end,
    [918] = function() set_reg(9, bit32.bxor(get_reg(9), get_reg(1))); end,
    [919] = function() ctx.PC = clamp16(893); end,
    [920] = function() add_reg(13,110); end,
    [921] = function() set_reg(14,90); end,
    [923] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [924] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [925] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [927] = function() ctx.PC = clamp16(933); end,
    [928] = function() ctx.I = 1376; end,
    [929] = function() set_reg(0,180); end,
    [930] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [931] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [933] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [934] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [935] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [937] = function() ctx.I = 746; end,
    [939] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [940] = function() ctx.PC = clamp16(3824); end,
    [941] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [942] = function() set_reg(5,98); end,
    [943] = function() set_reg(2,0); end,
    [945] = function() set_reg(3, get_reg(5)); end,
    [947] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [949] = function() local vx,vy = get_reg(7),get_reg(15);set_reg(7, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [951] = function() add_reg(3,255); end,
    [953] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [955] = function() ctx.PC = clamp16(959); end,
    [956] = function() ctx.PC = clamp16(get_reg(0) + 3859); end,
    [957] = function() ctx.PC = clamp16(947); end,
    [958] = function() ctx.PC = clamp16(get_reg(0) + 864); end,
    [959] = function() set_reg(0,32); end,
    [960] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 128; end,
    [961] = function() local vx,vy = get_reg(0),get_reg(5);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [963] = function() local vx,vy = get_reg(7),get_reg(0);set_reg(7, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [965] = function() set_reg(1, get_reg(12)); end,
    [966] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),129)); end,
    [967] = function() local vx,vy = get_reg(1),get_reg(9);set_reg(1, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [969] = function() set_reg(14, get_reg(13)); end,
    [970] = function() DRW_VX_VY_N(0, 8, 14); end,
    [971] = function() local vx,vy = get_reg(14),get_reg(7);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [972] = function() add_reg(5,63); end,
    [973] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [975] = function() ctx.PC = clamp16(985); end,
    [976] = function() DRW_VX_VY_N(9, 10, 2); end,
    [977] = function() ctx.I = 514; end,
    [979] = function() DRW_VX_VY_N(1, 7, 1); end,
    [980] = function() add_reg(1,119); end,
    [981] = function() add_reg(7,1); end,
    [983] = function() ctx.PC = clamp16(969); end,
    [984] = function() print('rand');set_reg(9, bit32.band(math.random(0, 255),120)); end,
    [985] = function() add_reg(8,1); end,
    [987] = function() add_reg(9,1); end,
    [989] = function() set_reg(14,8); end,
    [991] = function() local vx,vy = get_reg(14),get_reg(9);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [993] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [995] = function() ctx.PC = clamp16(885); end,
    [996] = function() add_reg(5,125); end,
    [997] = function() add_reg(13,251); end,
    [999] = function() ctx.I = 517; end,
    [1001] = function() DRW_VX_VY_N(12, 13, 6); end,
    [1002] = function() DRW_VX_VY_N(6, 12, 12); end,
    [1003] = function() print('rand');set_reg(12, bit32.band(math.random(0, 255),8)); end,
    [1005] = function() add_reg(12,252); end,
    [1007] = function() add_reg(12,55); end,
    [1008] = function() if get_reg(7) == 130 then ctx.PC = ctx.PC + 2 end end,
    [1009] = function() set_reg(2, get_reg(12)); end,
    [1010] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),130)); end,
    [1011] = function() local vx,vy = get_reg(2),get_reg(4);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1012] = function() if get_reg(4) ~= 129 then ctx.PC = ctx.PC + 2 end end,
    [1013] = function() set_reg(1, get_reg(2)); end,
    [1014] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 131; end,
    [1015] = function() set_reg(3, get_reg(6)); end,
    [1016] = function() set_reg(0,98); end,
    [1017] = function() set_reg(2,0); end,
    [1019] = function() set_reg(13,0); end,
    [1021] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1023] = function() ctx.PC = clamp16(1049); end,
    [1024] = function() ctx.PC = clamp16(2434); end,
    [1025] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1026] = function() ctx.PC = clamp16(1103); end,
    [1027] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1029] = function() add_reg(2,76); end,
    [1030] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [1031] = function() add_reg(3,255); end,
    [1033] = function() set_reg(14,180); end,
    [1034] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [1035] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1036] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [1037] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1039] = function() ctx.PC = clamp16(1047); end,
    [1040] = function() ctx.PC = clamp16(1888); end,
    [1041] = function() set_reg(0,180); end,
    [1042] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1043] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1045] = function() ctx.PC = clamp16(1033); end,
    [1047] = function() ctx.PC = clamp16(1021); end,
    [1049] = function() set_reg(14,90); end,
    [1051] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1052] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [1053] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1055] = function() ctx.PC = clamp16(1061); end,
    [1056] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1376; end,
    [1057] = function() set_reg(0,180); end,
    [1058] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1059] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1061] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1062] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [1063] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1065] = function() ctx.I = 746; end,
    [1067] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [1068] = function() ctx.PC = clamp16(3824); end,
    [1069] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1070] = function() set_reg(5,98); end,
    [1071] = function() set_reg(2,0); end,
    [1073] = function() set_reg(3, get_reg(5)); end,
    [1075] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1077] = function() local vx,vy = get_reg(13),get_reg(15);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1079] = function() add_reg(3,255); end,
    [1081] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1083] = function() ctx.PC = clamp16(1087); end,
    [1084] = function() if get_reg(15) == 20 then ctx.PC = ctx.PC + 2 end end,
    [1085] = function() ctx.PC = clamp16(1075); end,
    [1086] = function() if get_reg(3) == 96 then ctx.PC = ctx.PC + 2 end end,
    [1087] = function() set_reg(0,29); end,
    [1088] = function() ctx.PC = clamp16(3456); end,
    [1089] = function() local vx,vy = get_reg(0),get_reg(5);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1091] = function() local vx,vy = get_reg(13),get_reg(0);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1093] = function() set_reg(0, get_reg(12)); end,
    [1094] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),129)); end,
    [1095] = function() set_reg(1, get_reg(13)); end,
    [1096] = function() DRW_VX_VY_N(0, 10, 2); end,
    [1097] = function() ctx.I = 737; end,
    [1099] = function() for i=0, 1 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1101] = function() add_reg(12,252); end,
    [1103] = function() add_reg(13,2); end,
    [1105] = function() set_reg(8, get_reg(12)); end,
    [1106] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),136)); end,
    [1107] = function() local vx,vy = get_reg(8),get_reg(4);set_reg(8, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1108] = function() if get_reg(4) ~= 105 then ctx.PC = ctx.PC + 2 end end,
    [1109] = function() set_reg(9,0); end,
    [1111] = function() ctx.I = 514; end,
    [1113] = function() set_reg(1, get_reg(8)); end,
    [1114] = function() set_reg(0, bit32.bxor(get_reg(0), get_reg(8))); end,
    [1115] = function() set_reg(3, get_reg(6)); end,
    [1116] = function() set_reg(0,98); end,
    [1117] = function() set_reg(2,0); end,
    [1119] = function() set_reg(7,0); end,
    [1121] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1123] = function() ctx.PC = clamp16(1149); end,
    [1124] = function() add_reg(13,130); end,
    [1125] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1126] = function() ctx.PC = clamp16(1103); end,
    [1127] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1129] = function() add_reg(2,76); end,
    [1130] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [1131] = function() add_reg(3,255); end,
    [1133] = function() set_reg(14,180); end,
    [1134] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [1135] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1136] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [1137] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1139] = function() ctx.PC = clamp16(1147); end,
    [1140] = function() add_reg(11,96); end,
    [1141] = function() set_reg(0,180); end,
    [1142] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1143] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1145] = function() ctx.PC = clamp16(1133); end,
    [1146] = function() set_reg(13,20); end,
    [1147] = function() ctx.PC = clamp16(1121); end,
    [1148] = function() set_reg(1,110); end,
    [1149] = function() set_reg(14,90); end,
    [1151] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1152] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [1153] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1155] = function() ctx.PC = clamp16(1161); end,
    [1156] = function() set_reg(9, get_reg(6)); end,
    [1157] = function() set_reg(0,180); end,
    [1158] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1159] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1161] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1162] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [1163] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1165] = function() ctx.I = 746; end,
    [1167] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [1168] = function() ctx.PC = clamp16(3824); end,
    [1169] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1170] = function() set_reg(5,98); end,
    [1171] = function() set_reg(2,0); end,
    [1173] = function() set_reg(3, get_reg(5)); end,
    [1175] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1177] = function() local vx,vy = get_reg(7),get_reg(15);set_reg(7, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1179] = function() add_reg(3,255); end,
    [1181] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1183] = function() ctx.PC = clamp16(1187); end,
    [1184] = function() ctx.I = 788; end,
    [1185] = function() ctx.PC = clamp16(1175); end,
    [1186] = function() if get_reg(7) ~= get_reg(6) then ctx.PC = ctx.PC + 2 end end,
    [1187] = function() set_reg(0,32); end,
    [1188] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 128; end,
    [1189] = function() local vx,vy = get_reg(0),get_reg(5);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1191] = function() local vx,vy = get_reg(7),get_reg(0);set_reg(7, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1193] = function() set_reg(1, get_reg(12)); end,
    [1194] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),129)); end,
    [1195] = function() local vx,vy = get_reg(1),get_reg(9);set_reg(1, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1197] = function() set_reg(14, get_reg(13)); end,
    [1198] = function() DRW_VX_VY_N(0, 8, 14); end,
    [1199] = function() local vx,vy = get_reg(14),get_reg(7);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1200] = function() add_reg(5,63); end,
    [1201] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1203] = function() ctx.PC = clamp16(1213); end,
    [1204] = function() ctx.PC = clamp16(get_reg(0) + 3490); end,
    [1205] = function() ctx.I = 514; end,
    [1207] = function() DRW_VX_VY_N(1, 7, 1); end,
    [1208] = function() add_reg(1,119); end,
    [1209] = function() add_reg(7,1); end,
    [1211] = function() ctx.PC = clamp16(1197); end,
    [1212] = function() ctx.I = 3448; end,
    [1213] = function() add_reg(8,1); end,
    [1215] = function() add_reg(9,1); end,
    [1217] = function() set_reg(14,8); end,
    [1219] = function() local vx,vy = get_reg(14),get_reg(9);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1221] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1223] = function() ctx.PC = clamp16(1113); end,
    [1225] = function() add_reg(13,251); end,
    [1227] = function() ctx.I = 523; end,
    [1229] = function() DRW_VX_VY_N(12, 13, 6); end,
    [1230] = function() DRW_VX_VY_N(6, 12, 0); end,
    [1231] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),1)); end,
    [1233] = function() ctx.I = 742; end,
    [1235] = function() for i=0, 0 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1237] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1711; end,
    [1238] = function() ctx.I = 3880; end,
    [1239] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2099; end,
    [1240] = function() if get_reg(3) == 38 then ctx.PC = ctx.PC + 2 end end,
    [1241] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1565; end,
    [1242] = function() ctx.PC = clamp16(3424); end,
    [1243] = function() set_reg(0,100); end,
    [1244] = function() set_reg(4,240); end,
    [1245] = function() ctx.DT = get_reg(0); end,
    [1246] = function() ctx.PC = clamp16(1520); end,
    [1247] = function() set_reg(0, ctx.DT); end,
    [1249] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1251] = function() ctx.PC = clamp16(1247); end,
    [1252] = function() DRW_VX_VY_N(15, 3, 4); end,
    [1253] = function() if get_reg(4) == 3 then ctx.PC = ctx.PC + 2 end end,
    [1255] = function() ctx.PC = clamp16(1269); end,
    [1257] = function() ctx.I = 742; end,
    [1259] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1260] = function() set_reg(5,112); end,
    [1261] = function() add_reg(0,1); end,
    [1263] = function() ctx.I = 742; end,
    [1265] = function() for i=0, 0 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1267] = function() ctx.PC = clamp16(1237); end,
    [1268] = function() DRW_VX_VY_N(5, 3, 4); end,
    [1269] = function() if get_reg(4) == 2 then ctx.PC = ctx.PC + 2 end end,
    [1271] = function() ctx.PC = clamp16(1285); end,
    [1273] = function() ctx.I = 734; end,
    [1274] = function() DRW_VX_VY_N(14, 15, 0); end,
    [1275] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1276] = function() set_reg(5,112); end,
    [1277] = function() add_reg(0,1); end,
    [1279] = function() ctx.I = 734; end,
    [1280] = function() DRW_VX_VY_N(14, 15, 0); end,
    [1281] = function() for i=0, 0 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1283] = function() ctx.PC = clamp16(1295); end,
    [1285] = function() ctx.I = 739; end,
    [1287] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1288] = function() set_reg(5,112); end,
    [1289] = function() add_reg(0,1); end,
    [1291] = function() ctx.I = 739; end,
    [1293] = function() for i=0, 0 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1295] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1617; end,
    [1297] = function() ctx.PC = clamp16(771); end,
    [1299] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1301] = function() set_reg(12,25); end,
    [1302] = function() ctx.PC = clamp16(2413); end,
    [1303] = function() set_reg(13,1); end,
    [1305] = function() set_reg(5,15); end,
    [1307] = function() ctx.I = 553; end,
    [1308] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2400; end,
    [1309] = function() set_reg(0,4); end,
    [1311] = function() DRW_VX_VY_N(12, 13, 15); end,
    [1312] = function() DRW_VX_VY_N(15, 7, 12); end,
    [1313] = function() add_reg(12,8); end,
    [1315] = function() ctx.I = clamp16(ctx.I + get_reg(5)); end,
    [1316] = function() ctx.PC = clamp16(3696); end,
    [1317] = function() add_reg(0,255); end,
    [1319] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1321] = function() ctx.PC = clamp16(1311); end,
    [1322] = function() ctx.PC = clamp16(3948); end,
    [1323] = function() set_reg(12,25); end,
    [1324] = function() ctx.PC = clamp16(2413); end,
    [1325] = function() set_reg(13,16); end,
    [1326] = function() ctx.PC = clamp16(96); end,
    [1327] = function() set_reg(0,5); end,
    [1329] = function() DRW_VX_VY_N(12, 13, 15); end,
    [1330] = function() DRW_VX_VY_N(15, 7, 12); end,
    [1331] = function() add_reg(12,8); end,
    [1333] = function() ctx.I = clamp16(ctx.I + get_reg(5)); end,
    [1334] = function() ctx.PC = clamp16(3696); end,
    [1335] = function() add_reg(0,255); end,
    [1337] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1339] = function() ctx.PC = clamp16(1329); end,
    [1340] = function() if get_reg(1) == 96 then ctx.PC = ctx.PC + 2 end end,
    [1341] = function() set_reg(0,30); end,
    [1342] = function() ctx.PC = clamp16(3824); end,
    [1343] = function() ctx.DT = get_reg(0); end,
    [1344] = function() ctx.PC = clamp16(1520); end,
    [1345] = function() set_reg(0, ctx.DT); end,
    [1347] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1349] = function() ctx.PC = clamp16(1345); end,
    [1350] = function() if get_reg(1) ~= 108 then ctx.PC = ctx.PC + 2 end end,
    [1351] = function() set_reg(12,1); end,
    [1353] = function() set_reg(13,4); end,
    [1355] = function() set_reg(5,7); end,
    [1357] = function() ctx.I = 688; end,
    [1358] = function() ctx.PC = clamp16(get_reg(0) + 96); end,
    [1359] = function() set_reg(0,2); end,
    [1361] = function() DRW_VX_VY_N(12, 13, 7); end,
    [1362] = function() DRW_VX_VY_N(7, 7, 12); end,
    [1363] = function() add_reg(12,7); end,
    [1365] = function() ctx.I = clamp16(ctx.I + get_reg(5)); end,
    [1366] = function() ctx.PC = clamp16(3696); end,
    [1367] = function() add_reg(0,255); end,
    [1369] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1371] = function() ctx.PC = clamp16(1361); end,
    [1373] = function() set_reg(12,5); end,
    [1375] = function() set_reg(13,13); end,
    [1377] = function() set_reg(0,50); end,
    [1378] = function() if get_reg(2) == 240 then ctx.PC = ctx.PC + 2 end end,
    [1379] = function() ctx.DT = get_reg(0); end,
    [1380] = function() ctx.PC = clamp16(1520); end,
    [1381] = function() set_reg(0, ctx.DT); end,
    [1383] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1385] = function() ctx.PC = clamp16(1381); end,
    [1386] = function() set_reg(5,96); end,
    [1387] = function() set_reg(0,2); end,
    [1389] = function() DRW_VX_VY_N(12, 13, 7); end,
    [1390] = function() DRW_VX_VY_N(7, 7, 12); end,
    [1391] = function() add_reg(12,8); end,
    [1393] = function() ctx.I = clamp16(ctx.I + get_reg(5)); end,
    [1394] = function() ctx.PC = clamp16(3696); end,
    [1395] = function() add_reg(0,255); end,
    [1397] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1399] = function() ctx.PC = clamp16(1389); end,
    [1400] = function() set_reg(13,96); end,
    [1401] = function() set_reg(0,50); end,
    [1402] = function() if get_reg(2) == 240 then ctx.PC = ctx.PC + 2 end end,
    [1403] = function() ctx.DT = get_reg(0); end,
    [1404] = function() ctx.PC = clamp16(1520); end,
    [1405] = function() set_reg(0, ctx.DT); end,
    [1407] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1409] = function() ctx.PC = clamp16(1405); end,
    [1410] = function() add_reg(13,96); end,
    [1411] = function() set_reg(0,10); end,
    [1413] = function() ctx.ST = get_reg(0); end,
    [1414] = function() ctx.PC = clamp16(2268); end,
    [1415] = function() DRW_VX_VY_N(12, 13, 7); end,
    [1416] = function() DRW_VX_VY_N(7, 6, 0); end,
    [1417] = function() set_reg(0,200); end,
    [1418] = function() print('rand');set_reg(8, bit32.band(math.random(0, 255),240)); end,
    [1419] = function() ctx.DT = get_reg(0); end,
    [1420] = function() ctx.PC = clamp16(1520); end,
    [1421] = function() set_reg(0, ctx.DT); end,
    [1423] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1425] = function() ctx.PC = clamp16(1421); end,
    [1426] = function() set_reg(13, get_reg(0)); end,
    [1427] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1429] = function() set_reg(12,0); end,
    [1431] = function() print('rand');set_reg(4, bit32.band(math.random(0, 255),180)); end,
    [1432] = function() ctx.PC = clamp16(get_reg(0) + 1221); end,
    [1433] = function() print('rand');set_reg(5, bit32.band(math.random(0, 255),10)); end,
    [1435] = function() add_reg(5,6); end,
    [1437] = function() print('rand');set_reg(6, bit32.band(math.random(0, 255),4)); end,
    [1439] = function() add_reg(6,1); end,
    [1441] = function() set_reg(8, get_reg(12)); end,
    [1442] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),136)); end,
    [1443] = function() local vx,vy = get_reg(8),get_reg(4);set_reg(8, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1444] = function() if get_reg(4) ~= 129 then ctx.PC = ctx.PC + 2 end end,
    [1445] = function() set_reg(1, get_reg(8)); end,
    [1446] = function() set_reg(0, bit32.bxor(get_reg(0), get_reg(8))); end,
    [1447] = function() set_reg(3, get_reg(6)); end,
    [1448] = function() set_reg(0,98); end,
    [1449] = function() set_reg(2,0); end,
    [1451] = function() set_reg(13,0); end,
    [1453] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1455] = function() ctx.PC = clamp16(1481); end,
    [1456] = function() print('rand');set_reg(9, bit32.band(math.random(0, 255),130)); end,
    [1457] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1458] = function() ctx.PC = clamp16(1103); end,
    [1459] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1461] = function() add_reg(2,76); end,
    [1462] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [1463] = function() add_reg(3,255); end,
    [1465] = function() set_reg(14,180); end,
    [1466] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [1467] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1468] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [1469] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1471] = function() ctx.PC = clamp16(1479); end,
    [1472] = function() print('rand');set_reg(7, bit32.band(math.random(0, 255),96)); end,
    [1473] = function() set_reg(0,180); end,
    [1474] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1475] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1477] = function() ctx.PC = clamp16(1465); end,
    [1478] = function() ctx.PC = clamp16(get_reg(0) + 2325); end,
    [1479] = function() ctx.PC = clamp16(1453); end,
    [1480] = function() ctx.I = 3438; end,
    [1481] = function() set_reg(14,90); end,
    [1483] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1484] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [1485] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1487] = function() ctx.PC = clamp16(1493); end,
    [1488] = function() DRW_VX_VY_N(5, 6, 0); end,
    [1489] = function() set_reg(0,180); end,
    [1490] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [1491] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1493] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1494] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [1495] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1497] = function() ctx.I = 746; end,
    [1499] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [1500] = function() ctx.PC = clamp16(3824); end,
    [1501] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1502] = function() set_reg(5,98); end,
    [1503] = function() set_reg(2,0); end,
    [1505] = function() set_reg(3, get_reg(5)); end,
    [1507] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1509] = function() local vx,vy = get_reg(13),get_reg(15);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1511] = function() add_reg(3,255); end,
    [1513] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1515] = function() ctx.PC = clamp16(1519); end,
    [1517] = function() ctx.PC = clamp16(1507); end,
    [1519] = function() set_reg(0,32); end,
    [1520] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 128; end,
    [1521] = function() local vx,vy = get_reg(0),get_reg(5);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1523] = function() local vx,vy = get_reg(13),get_reg(0);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1525] = function() ctx.I = 514; end,
    [1527] = function() DRW_VX_VY_N(12, 13, 1); end,
    [1528] = function() DRW_VX_VY_N(1, 7, 13); end,
    [1529] = function() add_reg(13,1); end,
    [1531] = function() set_reg(14,32); end,
    [1532] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 142; end,
    [1533] = function() local vx,vy = get_reg(14),get_reg(13);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1534] = function() DRW_VX_VY_N(7, 4, 15); end,
    [1535] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1537] = function() ctx.PC = clamp16(1541); end,
    [1539] = function() ctx.PC = clamp16(1527); end,
    [1541] = function() add_reg(12,1); end,
    [1543] = function() set_reg(14,64); end,
    [1544] = function() if get_reg(0) ~= 142 then ctx.PC = ctx.PC + 2 end end,
    [1545] = function() local vx,vy = get_reg(14),get_reg(12);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1546] = function() print('rand');set_reg(7, bit32.band(math.random(0, 255),79)); end,
    [1547] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1549] = function() ctx.PC = clamp16(1553); end,
    [1550] = function() ctx.PC = clamp16(277); end,
    [1551] = function() ctx.PC = clamp16(1441); end,
    [1552] = function() ctx.I = 418; end,
    [1553] = function() ctx.I = 743; end,
    [1555] = function() set_reg(0, get_reg(4)); end,
    [1556] = function() if get_reg(0) ~= 129 then ctx.PC = ctx.PC + 2 end end,
    [1557] = function() set_reg(1, get_reg(6)); end,
    [1558] = function() set_reg(0,130); end,
    [1559] = function() set_reg(2, get_reg(5)); end,
    [1561] = function() for i=0, 2 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1562] = function() if get_reg(5) == get_reg(0) then ctx.PC = ctx.PC + 2 end end,
    [1563] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1565] = function() ctx.I = 529; end,
    [1566] = function() ctx.PC = clamp16(380); end,
    [1567] = function() add_reg(12,252); end,
    [1569] = function() add_reg(13,251); end,
    [1571] = function() DRW_VX_VY_N(12, 13, 8); end,
    [1572] = function() DRW_VX_VY_N(8, 6, 0); end,
    [1573] = function() set_reg(0,5); end,
    [1575] = function() ctx.DT = get_reg(0); end,
    [1576] = function() ctx.PC = clamp16(1520); end,
    [1577] = function() set_reg(0, ctx.DT); end,
    [1579] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1581] = function() ctx.PC = clamp16(1577); end,
    [1582] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2356; end,
    [1583] = function() if get_reg(4) == 3 then ctx.PC = ctx.PC + 2 end end,
    [1585] = function() ctx.PC = clamp16(1593); end,
    [1586] = function() if get_reg(9) == 162 then ctx.PC = ctx.PC + 2 end end,
    [1587] = function() ctx.I = 529; end,
    [1588] = function() ctx.PC = clamp16(476); end,
    [1589] = function() DRW_VX_VY_N(12, 13, 8); end,
    [1590] = function() DRW_VX_VY_N(8, 1, 6); end,
    [1591] = function() ctx.PC = clamp16(1615); end,
    [1592] = function() if get_reg(15) ~= 96 then ctx.PC = ctx.PC + 2 end end,
    [1593] = function() set_reg(0,10); end,
    [1595] = function() ctx.ST = get_reg(0); end,
    [1596] = function() ctx.PC = clamp16(2210); end,
    [1597] = function() ctx.I = 537; end,
    [1598] = function() ctx.PC = clamp16(2524); end,
    [1599] = function() DRW_VX_VY_N(12, 13, 8); end,
    [1600] = function() DRW_VX_VY_N(8, 6, 0); end,
    [1601] = function() set_reg(0,5); end,
    [1603] = function() ctx.DT = get_reg(0); end,
    [1604] = function() ctx.PC = clamp16(1520); end,
    [1605] = function() set_reg(0, ctx.DT); end,
    [1607] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1609] = function() ctx.PC = clamp16(1605); end,
    [1610] = function() if get_reg(5) ~= 162 then ctx.PC = ctx.PC + 2 end end,
    [1611] = function() ctx.I = 545; end,
    [1612] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 476; end,
    [1613] = function() DRW_VX_VY_N(12, 13, 8); end,
    [1614] = function() DRW_VX_VY_N(8, 0, 0); end,
    [1615] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1617] = function() CLS(); end,
    [1619] = function() set_reg(12,12); end,
    [1621] = function() set_reg(13,6); end,
    [1623] = function() ctx.I = 734; end,
    [1624] = function() DRW_VX_VY_N(14, 15, 0); end,
    [1625] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1626] = function() set_reg(5,131); end,
    [1627] = function() set_reg(3, get_reg(0)); end,
    [1629] = function() ctx.I = 729; end,
    [1630] = function() DRW_VX_VY_N(9, 15, 3); end,
    [1631] = function() FX_ops[0x33](3); end,
    [1632] = function() if get_reg(3) == 162 then ctx.PC = ctx.PC + 2 end end,
    [1633] = function() ctx.I = 729; end,
    [1634] = function() DRW_VX_VY_N(9, 15, 2); end,
    [1635] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1636] = function() set_reg(5,240); end,
    [1637] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [1638] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1639] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1640] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1641] = function() add_reg(12,5); end,
    [1643] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [1644] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1645] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1646] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1647] = function() add_reg(12,5); end,
    [1649] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [1650] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1651] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1652] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1653] = function() add_reg(12,16); end,
    [1654] = function() ctx.PC = clamp16(162); end,
    [1655] = function() ctx.I = 739; end,
    [1657] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1658] = function() set_reg(5,131); end,
    [1659] = function() set_reg(3, get_reg(0)); end,
    [1661] = function() ctx.I = 729; end,
    [1662] = function() DRW_VX_VY_N(9, 15, 3); end,
    [1663] = function() FX_ops[0x33](3); end,
    [1664] = function() if get_reg(3) == 162 then ctx.PC = ctx.PC + 2 end end,
    [1665] = function() ctx.I = 729; end,
    [1666] = function() DRW_VX_VY_N(9, 15, 2); end,
    [1667] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1668] = function() set_reg(5,240); end,
    [1669] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [1670] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1671] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1672] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1673] = function() add_reg(12,5); end,
    [1675] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [1676] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1677] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1678] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1679] = function() add_reg(12,5); end,
    [1681] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [1682] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1683] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1684] = function() DRW_VX_VY_N(5, 6, 12); end,
    [1685] = function() set_reg(12,14); end,
    [1687] = function() set_reg(13,18); end,
    [1688] = function() ctx.PC = clamp16(674); end,
    [1689] = function() ctx.I = 517; end,
    [1691] = function() DRW_VX_VY_N(12, 13, 6); end,
    [1692] = function() DRW_VX_VY_N(6, 6, 12); end,
    [1693] = function() set_reg(12,41); end,
    [1694] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2466; end,
    [1695] = function() ctx.I = 523; end,
    [1697] = function() DRW_VX_VY_N(12, 13, 6); end,
    [1698] = function() DRW_VX_VY_N(6, 6, 0); end,
    [1699] = function() set_reg(0,200); end,
    [1700] = function() print('rand');set_reg(8, bit32.band(math.random(0, 255),240)); end,
    [1701] = function() ctx.DT = get_reg(0); end,
    [1702] = function() ctx.PC = clamp16(1520); end,
    [1703] = function() set_reg(0, ctx.DT); end,
    [1705] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1707] = function() ctx.PC = clamp16(1703); end,
    [1708] = function() ctx.I = 1792; end,
    [1709] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1711] = function() set_reg(1,1); end,
    [1713] = function() set_reg(0, bit32.band(get_reg(0), get_reg(1))); end,
    [1714] = function() ctx.PC = clamp16(674); end,
    [1715] = function() ctx.I = 732; end,
    [1716] = function() DRW_VX_VY_N(12, 4, 0); end,
    [1717] = function() if get_reg(0) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1719] = function() ctx.I = 737; end,
    [1721] = function() for i=0, 4 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1722] = function() set_reg(5,135); end,
    [1723] = function() set_reg(7, get_reg(3)); end,
    [1724] = function() if get_reg(0) == 134 then ctx.PC = ctx.PC + 2 end end,
    [1725] = function() set_reg(6, get_reg(4)); end,
    [1726] = function() if get_reg(0) ~= 162 then ctx.PC = ctx.PC + 2 end end,
    [1727] = function() ctx.I = 515; end,
    [1729] = function() add_reg(0,255); end,
    [1731] = function() add_reg(1,248); end,
    [1733] = function() DRW_VX_VY_N(0, 1, 2); end,
    [1734] = function() ctx.PC = clamp16(551); end,
    [1735] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1951; end,
    [1736] = function() if get_reg(15) ~= get_reg(6) then ctx.PC = ctx.PC + 2 end end,
    [1737] = function() set_reg(0,5); end,
    [1739] = function() if ctx.keys[0]==1 then ctx.PC=ctx.PC+2 end; end,
    [1740] = function() ctx.I = 374; end,
    [1741] = function() add_reg(6,1); end,
    [1743] = function() set_reg(0,8); end,
    [1745] = function() if ctx.keys[0]==1 then ctx.PC=ctx.PC+2 end; end,
    [1746] = function() ctx.I = 374; end,
    [1747] = function() add_reg(6,255); end,
    [1749] = function() set_reg(0,7); end,
    [1751] = function() if ctx.keys[0]==1 then ctx.PC=ctx.PC+2 end; end,
    [1752] = function() ctx.I = 375; end,
    [1753] = function() add_reg(7,1); end,
    [1755] = function() set_reg(0,9); end,
    [1757] = function() if ctx.keys[0]==1 then ctx.PC=ctx.PC+2 end; end,
    [1758] = function() ctx.I = 375; end,
    [1759] = function() add_reg(7,255); end,
    [1761] = function() if get_reg(7) ~= 181 then ctx.PC = ctx.PC + 2 end end,
    [1762] = function() ctx.PC = clamp16(get_reg(0) + 1383); end,
    [1763] = function() set_reg(7,0); end,
    [1765] = function() if get_reg(7) ~= 255 then ctx.PC = ctx.PC + 2 end end,
    [1767] = function() set_reg(7,180); end,
    [1768] = function() ctx.PC = clamp16(get_reg(0) + 1094); end,
    [1769] = function() if get_reg(6) ~= 101 then ctx.PC = ctx.PC + 2 end end,
    [1770] = function() set_reg(5,102); end,
    [1771] = function() set_reg(6,1); end,
    [1773] = function() if get_reg(6) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1775] = function() set_reg(6,100); end,
    [1776] = function() set_reg(4,96); end,
    [1777] = function() set_reg(0,14); end,
    [1779] = function() if ctx.keys[0]==1 then ctx.PC=ctx.PC+2 end; end,
    [1780] = function() ctx.I = 279; end,
    [1781] = function() ctx.PC = clamp16(1797); end,
    [1783] = function() set_reg(0, ctx.DT); end,
    [1785] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [1787] = function() ctx.PC = clamp16(1783); end,
    [1789] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1999; end,
    [1790] = function() print('rand');set_reg(15, bit32.band(math.random(0, 255),96)); end,
    [1791] = function() set_reg(0,3); end,
    [1793] = function() ctx.DT = get_reg(0); end,
    [1794] = function() ctx.PC = clamp16(1302); end,
    [1795] = function() ctx.PC = clamp16(1737); end,
    [1796] = function() print('rand');set_reg(9, bit32.band(math.random(0, 255),39)); end,
    [1797] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1951; end,
    [1799] = function() ctx.I = 742; end,
    [1801] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1802] = function() set_reg(5,97); end,
    [1803] = function() set_reg(1,1); end,
    [1805] = function() set_reg(0, bit32.band(get_reg(0), get_reg(1))); end,
    [1806] = function() ctx.PC = clamp16(650); end,
    [1807] = function() set_reg(10, get_reg(0)); end,
    [1809] = function() ctx.I = 732; end,
    [1810] = function() DRW_VX_VY_N(12, 4, 0); end,
    [1811] = function() if get_reg(0) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1813] = function() ctx.I = 737; end,
    [1815] = function() set_reg(0,3); end,
    [1817] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [1818] = function() ctx.PC = clamp16(3712); end,
    [1819] = function() set_reg(0, get_reg(7)); end,
    [1820] = function() add_reg(0,129); end,
    [1821] = function() set_reg(1, get_reg(6)); end,
    [1822] = function() set_reg(0,241); end,
    [1823] = function() for i=0, 1 do set_ram(ctx.I + i, get_reg(i)) end; end,
    [1825] = function() set_reg(8,0); end,
    [1827] = function() set_reg(9,0); end,
    [1829] = function() set_reg(14,90); end,
    [1831] = function() local vx,vy = get_reg(14),get_reg(7);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1832] = function() add_reg(5,79); end,
    [1833] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [1835] = function() ctx.PC = clamp16(1845); end,
    [1836] = function() if get_reg(5) == 96 then ctx.PC = ctx.PC + 2 end end,
    [1837] = function() set_reg(0,180); end,
    [1838] = function() ctx.PC = clamp16(get_reg(0) + 1159); end,
    [1839] = function() local vx,vy = get_reg(7),get_reg(0);set_reg(7, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [1841] = function() set_reg(1,1); end,
    [1843] = function() ctx.PC = clamp16(1847); end,
    [1844] = function() if get_reg(7) == 97 then ctx.PC = ctx.PC + 2 end end,
    [1845] = function() set_reg(1,0); end,
    [1847] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1848] = function() add_reg(6,128); end,
    [1849] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1851] = function() ctx.I = 746; end,
    [1853] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [1854] = function() ctx.PC = clamp16(3824); end,
    [1855] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1856] = function() set_reg(5,98); end,
    [1857] = function() set_reg(2,0); end,
    [1859] = function() set_reg(3, get_reg(6)); end,
    [1860] = function() set_reg(0,130); end,
    [1861] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1863] = function() local vx,vy = get_reg(9),get_reg(15);set_reg(9, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1865] = function() add_reg(3,255); end,
    [1867] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1869] = function() ctx.PC = clamp16(1873); end,
    [1871] = function() ctx.PC = clamp16(1861); end,
    [1872] = function() if get_reg(5) ~= 128 then ctx.PC = ctx.PC + 2 end end,
    [1873] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1874] = function() add_reg(6,128); end,
    [1875] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [1877] = function() ctx.I = 746; end,
    [1879] = function() set_reg(2,22); end,
    [1880] = function() ctx.PC = clamp16(1666); end,
    [1881] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1883] = function() ctx.I = clamp16(ctx.I + get_reg(2)); end,
    [1884] = function() ctx.PC = clamp16(3824); end,
    [1885] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1886] = function() set_reg(5,98); end,
    [1887] = function() set_reg(2,0); end,
    [1889] = function() set_reg(3, get_reg(6)); end,
    [1890] = function() set_reg(0,130); end,
    [1891] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1893] = function() local vx,vy = get_reg(8),get_reg(15);set_reg(8, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1895] = function() add_reg(3,255); end,
    [1897] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [1899] = function() ctx.PC = clamp16(1903); end,
    [1900] = function() set_reg(15,23); end,
    [1901] = function() ctx.PC = clamp16(1891); end,
    [1902] = function() set_reg(3,49); end,
    [1903] = function() if get_reg(1) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1905] = function() ctx.PC = clamp16(1913); end,
    [1906] = function() add_reg(9,128); end,
    [1907] = function() set_reg(0, get_reg(8)); end,
    [1909] = function() set_reg(8,0); end,
    [1911] = function() local vx,vy = get_reg(8),get_reg(0);set_reg(8, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [1913] = function() if get_reg(10) == 1 then ctx.PC = ctx.PC + 2 end end,
    [1915] = function() ctx.PC = clamp16(1925); end,
    [1916] = function() set_reg(5, bit32.band(get_reg(5), get_reg(10))); end,
    [1917] = function() ctx.I = 732; end,
    [1918] = function() DRW_VX_VY_N(12, 6, 4); end,
    [1919] = function() set_reg(4,4); end,
    [1921] = function() set_reg(5,252); end,
    [1923] = function() ctx.PC = clamp16(1931); end,
    [1924] = function() set_reg(11, bit32.band(get_reg(11), get_reg(10))); end,
    [1925] = function() ctx.I = 737; end,
    [1927] = function() set_reg(4,251); end,
    [1928] = function() for i=0, 11 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1929] = function() set_reg(5,252); end,
    [1931] = function() for i=0, 1 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1932] = function() set_reg(5,140); end,
    [1933] = function() set_reg(12, get_reg(0)); end,
    [1935] = function() set_reg(13, get_reg(1)); end,
    [1936] = function() ctx.PC = clamp16(140); end,
    [1937] = function() local vx,vy = get_reg(12),get_reg(4);set_reg(12, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1938] = function() if get_reg(4) ~= 141 then ctx.PC = ctx.PC + 2 end end,
    [1939] = function() local vx,vy = get_reg(13),get_reg(5);set_reg(13, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [1941] = function() ctx.I = 515; end,
    [1943] = function() add_reg(0,255); end,
    [1945] = function() add_reg(1,248); end,
    [1947] = function() DRW_VX_VY_N(0, 1, 2); end,
    [1948] = function() ctx.PC = clamp16(512); end,
    [1949] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1951] = function() set_reg(12,15); end,
    [1953] = function() set_reg(13,1); end,
    [1955] = function() ctx.I = 726; end,
    [1956] = function() DRW_VX_VY_N(6, 15, 2); end,
    [1957] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1958] = function() set_reg(5,240); end,
    [1959] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [1960] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1961] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1962] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1963] = function() add_reg(12,5); end,
    [1965] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [1966] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1967] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1968] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1969] = function() add_reg(12,5); end,
    [1971] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [1972] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1973] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1974] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1975] = function() add_reg(12,10); end,
    [1977] = function() ctx.I = 723; end,
    [1978] = function() DRW_VX_VY_N(3, 15, 2); end,
    [1979] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [1980] = function() set_reg(5,240); end,
    [1981] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [1982] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1983] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1984] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1985] = function() add_reg(12,5); end,
    [1987] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [1988] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1989] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1990] = function() DRW_VX_VY_N(5, 7, 12); end,
    [1991] = function() add_reg(12,5); end,
    [1993] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [1994] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [1995] = function() DRW_VX_VY_N(12, 13, 5); end,
    [1996] = function() DRW_VX_VY_N(5, 0, 0); end,
    [1997] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [1999] = function() set_reg(12,15); end,
    [2001] = function() set_reg(13,1); end,
    [2003] = function() ctx.I = 726; end,
    [2004] = function() DRW_VX_VY_N(6, 15, 2); end,
    [2005] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2006] = function() set_reg(5,131); end,
    [2007] = function() set_reg(3, get_reg(0)); end,
    [2009] = function() set_reg(4, get_reg(1)); end,
    [2010] = function() ctx.PC = clamp16(133); end,
    [2011] = function() set_reg(5, get_reg(2)); end,
    [2012] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 162; end,
    [2013] = function() ctx.I = 726; end,
    [2014] = function() DRW_VX_VY_N(6, 15, 7); end,
    [2015] = function() FX_ops[0x33](7); end,
    [2016] = function() if get_reg(3) == 162 then ctx.PC = ctx.PC + 2 end end,
    [2017] = function() ctx.I = 726; end,
    [2018] = function() DRW_VX_VY_N(6, 15, 2); end,
    [2019] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2020] = function() set_reg(5,243); end,
    [2021] = function() ctx.I = clamp16(get_reg(3) * 5); end,
    [2022] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2023] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2024] = function() DRW_VX_VY_N(5, 15, 0); end,
    [2025] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [2026] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2027] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2028] = function() DRW_VX_VY_N(5, 7, 12); end,
    [2029] = function() add_reg(12,5); end,
    [2031] = function() ctx.I = clamp16(get_reg(4) * 5); end,
    [2032] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2033] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2034] = function() DRW_VX_VY_N(5, 15, 1); end,
    [2035] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [2036] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2037] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2038] = function() DRW_VX_VY_N(5, 7, 12); end,
    [2039] = function() add_reg(12,5); end,
    [2041] = function() ctx.I = clamp16(get_reg(5) * 5); end,
    [2042] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2043] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2044] = function() DRW_VX_VY_N(5, 15, 2); end,
    [2045] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [2046] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2047] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2048] = function() DRW_VX_VY_N(5, 7, 12); end,
    [2049] = function() add_reg(12,10); end,
    [2051] = function() ctx.I = 723; end,
    [2052] = function() DRW_VX_VY_N(3, 15, 2); end,
    [2053] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2054] = function() set_reg(5,131); end,
    [2055] = function() set_reg(3, get_reg(0)); end,
    [2057] = function() set_reg(4, get_reg(1)); end,
    [2058] = function() ctx.PC = clamp16(133); end,
    [2059] = function() set_reg(5, get_reg(2)); end,
    [2060] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 162; end,
    [2061] = function() ctx.I = 723; end,
    [2062] = function() DRW_VX_VY_N(3, 15, 6); end,
    [2063] = function() FX_ops[0x33](6); end,
    [2064] = function() if get_reg(3) == 162 then ctx.PC = ctx.PC + 2 end end,
    [2065] = function() ctx.I = 723; end,
    [2066] = function() DRW_VX_VY_N(3, 15, 2); end,
    [2067] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2068] = function() set_reg(5,243); end,
    [2069] = function() ctx.I = clamp16(get_reg(3) * 5); end,
    [2070] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2071] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2072] = function() DRW_VX_VY_N(5, 15, 0); end,
    [2073] = function() ctx.I = clamp16(get_reg(0) * 5); end,
    [2074] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2075] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2076] = function() DRW_VX_VY_N(5, 7, 12); end,
    [2077] = function() add_reg(12,5); end,
    [2079] = function() ctx.I = clamp16(get_reg(4) * 5); end,
    [2080] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2081] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2082] = function() DRW_VX_VY_N(5, 15, 1); end,
    [2083] = function() ctx.I = clamp16(get_reg(1) * 5); end,
    [2084] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2085] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2086] = function() DRW_VX_VY_N(5, 7, 12); end,
    [2087] = function() add_reg(12,5); end,
    [2089] = function() ctx.I = clamp16(get_reg(5) * 5); end,
    [2090] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2091] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2092] = function() DRW_VX_VY_N(5, 15, 2); end,
    [2093] = function() ctx.I = clamp16(get_reg(2) * 5); end,
    [2094] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2524; end,
    [2095] = function() DRW_VX_VY_N(12, 13, 5); end,
    [2096] = function() DRW_VX_VY_N(5, 0, 0); end,
    [2097] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2099] = function() set_reg(6,0); end,
    [2101] = function() set_reg(7,0); end,
    [2103] = function() set_reg(11,0); end,
    [2105] = function() set_reg(5,0); end,
    [2107] = function() local vx = get_reg(0);set_reg(0, bit32.lshift(vx, 1));set_reg(0xF, (bit32.band(vx, 0x80) == 0) and 0 or 1); end,
    [2109] = function() if get_reg(15) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [2111] = function() ctx.PC = clamp16(2131); end,
    [2113] = function() set_reg(1,255); end,
    [2115] = function() set_reg(0, bit32.bxor(get_reg(0), get_reg(1))); end,
    [2116] = function() ctx.PC = clamp16(902); end,
    [2117] = function() local vx,vy = get_reg(6),get_reg(0);set_reg(6, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2119] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2121] = function() ctx.PC = clamp16(2129); end,
    [2122] = function() if get_reg(1) == get_reg(6) then ctx.PC = ctx.PC + 2 end end,
    [2123] = function() set_reg(0,1); end,
    [2125] = function() local vx,vy = get_reg(12),get_reg(0);set_reg(12, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2127] = function() set_reg(5,1); end,
    [2129] = function() ctx.PC = clamp16(2141); end,
    [2131] = function() local vx,vy = get_reg(6),get_reg(0);set_reg(6, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2133] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2135] = function() ctx.PC = clamp16(2141); end,
    [2137] = function() add_reg(12,1); end,
    [2139] = function() set_reg(5,1); end,
    [2141] = function() local vx = get_reg(0);set_reg(0, bit32.lshift(vx, 1));set_reg(0xF, (bit32.band(vx, 0x80) == 0) and 0 or 1); end,
    [2143] = function() if get_reg(15) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [2145] = function() ctx.PC = clamp16(2165); end,
    [2146] = function() add_reg(5,97); end,
    [2147] = function() set_reg(1,255); end,
    [2149] = function() set_reg(0, bit32.bxor(get_reg(0), get_reg(1))); end,
    [2150] = function() ctx.PC = clamp16(903); end,
    [2151] = function() local vx,vy = get_reg(7),get_reg(0);set_reg(7, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2153] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2155] = function() ctx.PC = clamp16(2163); end,
    [2156] = function() add_reg(3,96); end,
    [2157] = function() set_reg(0,255); end,
    [2159] = function() local vx,vy = get_reg(13),get_reg(0);set_reg(13, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2161] = function() set_reg(5,1); end,
    [2163] = function() ctx.PC = clamp16(2175); end,
    [2164] = function() add_reg(15,135); end,
    [2165] = function() local vx,vy = get_reg(7),get_reg(0);set_reg(7, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2167] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2169] = function() ctx.PC = clamp16(2175); end,
    [2170] = function() add_reg(15,125); end,
    [2171] = function() add_reg(13,255); end,
    [2172] = function() for i=0, 15 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2173] = function() set_reg(5,1); end,
    [2175] = function() if get_reg(12) ~= 255 then ctx.PC = ctx.PC + 2 end end,
    [2177] = function() set_reg(12,63); end,
    [2178] = function() if get_reg(15) == 76 then ctx.PC = ctx.PC + 2 end end,
    [2179] = function() if get_reg(12) ~= 64 then ctx.PC = ctx.PC + 2 end end,
    [2180] = function() if get_reg(0) ~= 108 then ctx.PC = ctx.PC + 2 end end,
    [2181] = function() set_reg(12,0); end,
    [2183] = function() set_reg(14,32); end,
    [2184] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 142; end,
    [2185] = function() local vx,vy = get_reg(14),get_reg(13);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2186] = function() DRW_VX_VY_N(7, 4, 15); end,
    [2187] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2189] = function() set_reg(5,0); end,
    [2191] = function() set_reg(14,7); end,
    [2193] = function() local vx,vy = get_reg(14),get_reg(13);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2194] = function() DRW_VX_VY_N(7, 4, 15); end,
    [2195] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2197] = function() ctx.PC = clamp16(2231); end,
    [2198] = function() ctx.PC = clamp16(get_reg(0) + 1902); end,
    [2199] = function() set_reg(14,14); end,
    [2201] = function() local vx,vy = get_reg(14),get_reg(12);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2202] = function() print('rand');set_reg(7, bit32.band(math.random(0, 255),63)); end,
    [2203] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2205] = function() ctx.PC = clamp16(2231); end,
    [2206] = function() ctx.PC = clamp16(get_reg(0) + 1902); end,
    [2207] = function() set_reg(14,50); end,
    [2208] = function() if get_reg(2) == 142 then ctx.PC = ctx.PC + 2 end end,
    [2209] = function() local vx,vy = get_reg(14),get_reg(12);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2210] = function() print('rand');set_reg(7, bit32.band(math.random(0, 255),79)); end,
    [2211] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2213] = function() ctx.PC = clamp16(2231); end,
    [2214] = function() ctx.PC = clamp16(get_reg(0) + 1902); end,
    [2215] = function() set_reg(14,33); end,
    [2216] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 398; end,
    [2217] = function() local vx,vy = get_reg(14),get_reg(12);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2218] = function() print('rand');set_reg(5, bit32.band(math.random(0, 255),63)); end,
    [2219] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2221] = function() set_reg(5,0); end,
    [2223] = function() set_reg(14,30); end,
    [2224] = function() ctx.PC = clamp16(3726); end,
    [2225] = function() local vx,vy = get_reg(14),get_reg(12);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2226] = function() print('rand');set_reg(7, bit32.band(math.random(0, 255),63)); end,
    [2227] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2229] = function() set_reg(5,0); end,
    [2231] = function() set_reg(15,0); end,
    [2233] = function() if get_reg(5) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [2235] = function() ctx.PC = clamp16(2241); end,
    [2236] = function() print('rand');set_reg(1, bit32.band(math.random(0, 255),162)); end,
    [2237] = function() ctx.I = 514; end,
    [2239] = function() DRW_VX_VY_N(12, 13, 1); end,
    [2240] = function() DRW_VX_VY_N(1, 2, 8); end,
    [2241] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 2269; end,
    [2242] = function() DRW_VX_VY_N(13, 3, 4); end,
    [2243] = function() if get_reg(4) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2245] = function() ctx.PC = clamp16(2267); end,
    [2246] = function() DRW_VX_VY_N(11, 6, 0); end,
    [2247] = function() set_reg(0,128); end,
    [2249] = function() local vx,vy = get_reg(11),get_reg(0);set_reg(11, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2251] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2253] = function() add_reg(9,255); end,
    [2255] = function() set_reg(0, ctx.DT); end,
    [2257] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2259] = function() ctx.PC = clamp16(2255); end,
    [2260] = function() print('rand');set_reg(15, bit32.band(math.random(0, 255),96)); end,
    [2261] = function() set_reg(0,1); end,
    [2263] = function() ctx.DT = get_reg(0); end,
    [2264] = function() ctx.PC = clamp16(1304); end,
    [2265] = function() ctx.PC = clamp16(2105); end,
    [2266] = function() if get_reg(9) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2267] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2269] = function() set_reg(0, get_reg(15)); end,
    [2271] = function() set_reg(4,3); end,
    [2273] = function() if get_reg(13) ~= 31 then ctx.PC = ctx.PC + 2 end end,
    [2274] = function() ctx.PC = clamp16(3840); end,
    [2275] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2277] = function() if get_reg(0) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2279] = function() ctx.PC = clamp16(2285); end,
    [2281] = function() set_reg(4,0); end,
    [2283] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2285] = function() ctx.I = 732; end,
    [2286] = function() DRW_VX_VY_N(12, 15, 1); end,
    [2287] = function() for i=0, 1 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2288] = function() set_reg(5,128); end,
    [2289] = function() local vx,vy = get_reg(0),get_reg(12);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2290] = function() print('rand');set_reg(5, bit32.band(math.random(0, 255),63)); end,
    [2291] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2293] = function() ctx.PC = clamp16(2305); end,
    [2295] = function() set_reg(2,3); end,
    [2297] = function() local vx,vy = get_reg(0),get_reg(2);set_reg(0, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2298] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1087; end,
    [2299] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2301] = function() set_reg(4,1); end,
    [2303] = function() ctx.PC = clamp16(2313); end,
    [2305] = function() set_reg(14,3); end,
    [2307] = function() local vx,vy = get_reg(14),get_reg(0);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2309] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2311] = function() set_reg(4,1); end,
    [2313] = function() if get_reg(4) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2315] = function() ctx.PC = clamp16(2341); end,
    [2316] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1409; end,
    [2317] = function() local vx,vy = get_reg(1),get_reg(13);set_reg(1, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2318] = function() DRW_VX_VY_N(5, 3, 15); end,
    [2319] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2321] = function() ctx.PC = clamp16(2333); end,
    [2322] = function() ctx.PC = clamp16(3426); end,
    [2323] = function() set_reg(2,2); end,
    [2325] = function() local vx,vy = get_reg(1),get_reg(2);set_reg(1, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2326] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1087; end,
    [2327] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2329] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2331] = function() ctx.PC = clamp16(2341); end,
    [2332] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1390; end,
    [2333] = function() set_reg(14,2); end,
    [2335] = function() local vx,vy = get_reg(14),get_reg(1);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2336] = function() ctx.PC = clamp16(1359); end,
    [2337] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2339] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2341] = function() ctx.I = 737; end,
    [2343] = function() for i=0, 1 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2344] = function() set_reg(5,128); end,
    [2345] = function() local vx,vy = get_reg(0),get_reg(12);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2346] = function() print('rand');set_reg(5, bit32.band(math.random(0, 255),63)); end,
    [2347] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2349] = function() ctx.PC = clamp16(2361); end,
    [2350] = function() if get_reg(9) == 98 then ctx.PC = ctx.PC + 2 end end,
    [2351] = function() set_reg(2,3); end,
    [2353] = function() local vx,vy = get_reg(0),get_reg(2);set_reg(0, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2354] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1087; end,
    [2355] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2357] = function() set_reg(4,2); end,
    [2359] = function() ctx.PC = clamp16(2369); end,
    [2360] = function() if get_reg(1) ~= 110 then ctx.PC = ctx.PC + 2 end end,
    [2361] = function() set_reg(14,3); end,
    [2363] = function() local vx,vy = get_reg(14),get_reg(0);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2365] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2367] = function() set_reg(4,2); end,
    [2369] = function() if get_reg(4) == 2 then ctx.PC = ctx.PC + 2 end end,
    [2371] = function() ctx.PC = clamp16(2397); end,
    [2373] = function() local vx,vy = get_reg(1),get_reg(13);set_reg(1, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2374] = function() DRW_VX_VY_N(5, 3, 15); end,
    [2375] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2377] = function() ctx.PC = clamp16(2389); end,
    [2379] = function() set_reg(2,2); end,
    [2381] = function() local vx,vy = get_reg(1),get_reg(2);set_reg(1, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2382] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1087; end,
    [2383] = function() if get_reg(15) == 0 then ctx.PC = ctx.PC + 2 end end,
    [2385] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2387] = function() ctx.PC = clamp16(2397); end,
    [2389] = function() set_reg(14,2); end,
    [2391] = function() local vx,vy = get_reg(14),get_reg(1);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2392] = function() ctx.PC = clamp16(1359); end,
    [2393] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2395] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2397] = function() ctx.I = 743; end,
    [2399] = function() for i=0, 2 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2400] = function() set_reg(5,132); end,
    [2401] = function() set_reg(4, get_reg(2)); end,
    [2402] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 142; end,
    [2403] = function() set_reg(14, get_reg(1)); end,
    [2404] = function() ctx.PC = clamp16(131); end,
    [2405] = function() set_reg(3, get_reg(12)); end,
    [2406] = function() print('rand');set_reg(0, bit32.band(math.random(0, 255),131)); end,
    [2407] = function() local vx,vy = get_reg(3),get_reg(0);set_reg(3, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2409] = function() set_reg(1, get_reg(3)); end,
    [2410] = function() if get_reg(0) == 131 then ctx.PC = ctx.PC + 2 end end,
    [2411] = function() set_reg(3, get_reg(14)); end,
    [2413] = function() set_reg(2,0); end,
    [2415] = function() set_reg(10,0); end,
    [2417] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [2419] = function() ctx.PC = clamp16(2445); end,
    [2420] = function() set_reg(13, bit32.band(get_reg(13), get_reg(8))); end,
    [2421] = function() local vx,vy = get_reg(2),get_reg(1);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2422] = function() ctx.PC = clamp16(1103); end,
    [2423] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2425] = function() add_reg(2,76); end,
    [2426] = function() if get_reg(12) ~= 115 then ctx.PC = ctx.PC + 2 end end,
    [2427] = function() add_reg(3,255); end,
    [2429] = function() set_reg(14,180); end,
    [2430] = function() ctx.PC = clamp16(get_reg(0) + 1166); end,
    [2431] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2432] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1855; end,
    [2433] = function() if get_reg(15) == 1 then ctx.PC = ctx.PC + 2 end end,
    [2435] = function() ctx.PC = clamp16(2443); end,
    [2436] = function() set_reg(11, get_reg(6)); end,
    [2437] = function() set_reg(0,180); end,
    [2438] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [2439] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2441] = function() ctx.PC = clamp16(2429); end,
    [2442] = function() add_reg(13,25); end,
    [2443] = function() ctx.PC = clamp16(2417); end,
    [2444] = function() add_reg(1,110); end,
    [2445] = function() set_reg(14,90); end,
    [2447] = function() local vx,vy = get_reg(14),get_reg(2);set_reg(14, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2448] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1359; end,
    [2449] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2451] = function() ctx.PC = clamp16(2457); end,
    [2452] = function() if get_reg(9) ~= get_reg(6) then ctx.PC = ctx.PC + 2 end end,
    [2453] = function() set_reg(0,180); end,
    [2454] = function() ctx.PC = clamp16(get_reg(0) + 1154); end,
    [2455] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2457] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [2458] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 1664; end,
    [2459] = function() local vx = get_reg(0);set_reg(0, bit32.rshift(vx, 1));set_reg(0xF, bit32.band(vx, 0x01)); end,
    [2461] = function() ctx.I = 746; end,
    [2463] = function() ctx.I = clamp16(ctx.I + get_reg(0)); end,
    [2464] = function() ctx.PC = clamp16(3824); end,
    [2465] = function() for i=0, 0 do set_reg(i, get_ram(ctx.I + i)) end; end,
    [2466] = function() set_reg(5,98); end,
    [2467] = function() set_reg(2,0); end,
    [2469] = function() set_reg(3, get_reg(4)); end,
    [2470] = function() if get_reg(0) ~= 130 then ctx.PC = ctx.PC + 2 end end,
    [2471] = function() local vx,vy = get_reg(2),get_reg(0);set_reg(2, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2473] = function() local vx,vy = get_reg(10),get_reg(15);set_reg(10, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2475] = function() add_reg(3,255); end,
    [2477] = function() if get_reg(3) ~= 0 then ctx.PC = ctx.PC + 2 end end,
    [2479] = function() ctx.PC = clamp16(2483); end,
    [2480] = function() ctx.PC = clamp16(get_reg(0) + 793); end,
    [2481] = function() ctx.PC = clamp16(2471); end,
    [2482] = function() ctx.I = 1888; end,
    [2483] = function() set_reg(0,32); end,
    [2484] = function() ctx.stack[ctx.SP] = ctx.PC;ctx.SP = clamp8(ctx.SP + 1);ctx.PC = 128; end,
    [2485] = function() local vx,vy = get_reg(0),get_reg(4);set_reg(0, vx - vy);set_reg(0xF, vy > vx and 0 or 1); end,
    [2486] = function() if get_reg(5) ~= 138 then ctx.PC = ctx.PC + 2 end end,
    [2487] = function() local vx,vy = get_reg(10),get_reg(0);set_reg(10, vx + vy);set_reg(0xF, (vx + vy) > 0xFF and 1 or 0); end,
    [2489] = function() set_reg(14, get_reg(13)); end,
    [2490] = function() DRW_VX_VY_N(0, 8, 14); end,
    [2491] = function() local vx,vy = get_reg(14),get_reg(10);set_reg(14, vy - vx);set_reg(0xF, vx > vy and 0 or 1); end,
    [2492] = function() ctx.I = 1871; end,
    [2493] = function() if get_reg(15) ~= 1 then ctx.PC = ctx.PC + 2 end end,
    [2495] = function() ctx.PC = clamp16(2501); end,
    [2496] = function() print('rand');set_reg(5, bit32.band(math.random(0, 255),100)); end,
    [2497] = function() set_reg(4,3); end,
    [2499] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
    [2501] = function() set_reg(4,0); end,
    [2503] = function() ctx.SP = clamp8(ctx.SP - 1);ctx.PC = ctx.stack[ctx.SP]; end,
}
write_table_to_ram(0x200, {
    0x13,0x1,0x80,0xa0,0x40,0x1,0x1a,0x24,
    0x7e,0x81,0x7e,0x80,0x58,0x24,0x7e,0x81,
    0x7e,0x0,0x0,0x28,0x5c,0x3a,0x14,0x0,
    0x0,0x82,0x55,0xa,0x14,0x28,0x50,0xaa,
    0x41,0x82,0x55,0x22,0x48,0x12,0x44,0xaa,
    0x41,0x0,0x30,0x5c,0x3f,0xf,0x1,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x2,
    0x0,0x0,0x0,0x0,0xc0,0xf7,0x7e,0x1f,
    0x13,0x10,0x8,0x17,0x60,0x80,0x30,0x60,
    0x1f,0x7,0x5,0x4,0xfb,0x4,0x92,0xc2,
    0x82,0x5,0xfa,0x2,0x1,0x0,0x0,0x0,
    0x82,0x82,0x2,0x4,0xe4,0x18,0x4,0x2,
    0x2,0xe4,0x1c,0x2,0xf9,0x2,0x1c,0x3f,
    0x48,0x85,0xfa,0x8a,0x45,0x75,0x44,0x3a,
    0x23,0x1d,0x11,0xe,0xc8,0x28,0xff,0x0,
    0xfc,0x2,0xfa,0x1,0x1,0x81,0x80,0x0,
    0x0,0xa8,0xc0,0x1,0x1e,0xbf,0x44,0x88,
    0xfa,0x88,0x44,0x76,0x45,0xfa,0x22,0x3d,
    0x11,0xe,0x7,0x1,0x80,0x70,0x4e,0x25,
    0x25,0x22,0x40,0xa2,0x15,0x95,0x12,0x2f,
    0xf0,0x0,0x80,0x60,0x10,0x8,0xc8,0x38,
    0x14,0xc,0xa4,0x54,0x58,0xf0,0x0,0x0,
    0xfc,0xfc,0x30,0x30,0x30,0x30,0x30,0x30,
    0x30,0x78,0x48,0xec,0xcc,0x84,0xcc,0xcc,
    0xec,0xfc,0xdc,0xcc,0xcc,0xd8,0xf0,0xe0,
    0xe0,0xf0,0xd8,0xd8,0xc0,0xc0,0xc0,0xc0,
    0x0,0xc0,0xc0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x7,0x1d,0x0,0x2d,
    0x28,0x38,0x1d,0x0,0x87,0x28,0x1,0x0,
    0x0,0x0,0x0,0x12,0x24,0x36,0x48,0x59,
    0x6a,0x7b,0x8a,0x99,0xa8,0xb5,0xc1,0xcd,
    0xd7,0xe1,0xe9,0xf0,0xf6,0xfa,0xfd,0xff,
    0xff,0x25,0x15,0x0,0xe0,0x25,0x95,0xcc,
    0x8,0x7c,0xfc,0x7c,0x8,0x82,0xc0,0x82,
    0x44,0x81,0x20,0x83,0x60,0x62,0x0,0x6d,
    0x0,0x43,0x0,0x13,0x35,0x82,0x14,0x4f,
    0x1,0x72,0x4c,0x73,0xff,0x6e,0xb4,0x8e,
    0x27,0x3f,0x1,0x13,0x33,0x60,0xb4,0x82,
    0x5,0x13,0x25,0x13,0x19,0x6e,0x5a,0x8e,
    0x25,0x4f,0x1,0x13,0x41,0x60,0xb4,0x82,
    0x7,0x80,0x26,0x80,0x6,0xa2,0xea,0xf0,
    0x1e,0xf0,0x65,0x62,0x0,0x83,0x50,0x82,
    0x4,0x8d,0xf4,0x73,0xff,0x43,0x0,0x13,
    0x5b,0x13,0x4f,0x60,0x1d,0x80,0x55,0x8d,
    0x4,0x80,0xc0,0x81,0xd0,0xa2,0xdc,0xf1,
    0x55,0x7c,0xfc,0x7d,0x2,0x88,0xc0,0x88,
    0x44,0x69,0x0,0xa2,0x2,0x81,0x80,0x83,
    0x60,0x62,0x0,0x67,0x0,0x43,0x0,0x13,
    0x99,0x82,0x14,0x4f,0x1,0x72,0x4c,0x73,
    0xff,0x6e,0xb4,0x8e,0x27,0x3f,0x1,0x13,
    0x97,0x60,0xb4,0x82,0x5,0x13,0x89,0x13,
    0x7d,0x6e,0x5a,0x8e,0x25,0x4f,0x1,0x13,
    0xa5,0x60,0xb4,0x82,0x7,0x80,0x26,0x80,
    0x6,0xa2,0xea,0xf0,0x1e,0xf0,0x65,0x62,
    0x0,0x83,0x50,0x82,0x4,0x87,0xf4,0x73,
    0xff,0x43,0x0,0x13,0xbf,0x13,0xb3,0x60,
    0x20,0x80,0x55,0x87,0x4,0x81,0xc0,0x81,
    0x94,0x8e,0xd0,0x8e,0x75,0x3f,0x1,0x13,
    0xd9,0xa2,0x2,0xd1,0x71,0x77,0x1,0x13,
    0xc9,0x78,0x1,0x79,0x1,0x6e,0x8,0x8e,
    0x97,0x3f,0x1,0x13,0x75,0x7d,0xfb,0xa2,
    0x5,0xdc,0xd6,0xcc,0x8,0x7c,0xfc,0x7c,
    0x37,0x82,0xc0,0x82,0x44,0x81,0x20,0x83,
    0x60,0x62,0x0,0x6d,0x0,0x43,0x0,0x14,
    0x19,0x82,0x14,0x4f,0x1,0x72,0x4c,0x73,
    0xff,0x6e,0xb4,0x8e,0x27,0x3f,0x1,0x14,
    0x17,0x60,0xb4,0x82,0x5,0x14,0x9,0x13,
    0xfd,0x6e,0x5a,0x8e,0x25,0x4f,0x1,0x14,
    0x25,0x60,0xb4,0x82,0x7,0x80,0x26,0x80,
    0x6,0xa2,0xea,0xf0,0x1e,0xf0,0x65,0x62,
    0x0,0x83,0x50,0x82,0x4,0x8d,0xf4,0x73,
    0xff,0x43,0x0,0x14,0x3f,0x14,0x33,0x60,
    0x1d,0x80,0x55,0x8d,0x4,0x80,0xc0,0x81,
    0xd0,0xa2,0xe1,0xf1,0x55,0x7c,0xfc,0x7d,
    0x2,0x88,0xc0,0x88,0x44,0x69,0x0,0xa2,
    0x2,0x81,0x80,0x83,0x60,0x62,0x0,0x67,
    0x0,0x43,0x0,0x14,0x7d,0x82,0x14,0x4f,
    0x1,0x72,0x4c,0x73,0xff,0x6e,0xb4,0x8e,
    0x27,0x3f,0x1,0x14,0x7b,0x60,0xb4,0x82,
    0x5,0x14,0x6d,0x14,0x61,0x6e,0x5a,0x8e,
    0x25,0x4f,0x1,0x14,0x89,0x60,0xb4,0x82,
    0x7,0x80,0x26,0x80,0x6,0xa2,0xea,0xf0,
    0x1e,0xf0,0x65,0x62,0x0,0x83,0x50,0x82,
    0x4,0x87,0xf4,0x73,0xff,0x43,0x0,0x14,
    0xa3,0x14,0x97,0x60,0x20,0x80,0x55,0x87,
    0x4,0x81,0xc0,0x81,0x94,0x8e,0xd0,0x8e,
    0x75,0x3f,0x1,0x14,0xbd,0xa2,0x2,0xd1,
    0x71,0x77,0x1,0x14,0xad,0x78,0x1,0x79,
    0x1,0x6e,0x8,0x8e,0x97,0x3f,0x1,0x14,
    0x59,0x7d,0xfb,0xa2,0xb,0xdc,0xd6,0xc0,
    0x1,0xa2,0xe6,0xf0,0x55,0x26,0xaf,0x28,
    0x33,0x26,0x1d,0x60,0x64,0xf0,0x15,0xf0,
    0x7,0x30,0x0,0x14,0xdf,0x34,0x3,0x14,
    0xf5,0xa2,0xe6,0xf0,0x65,0x70,0x1,0xa2,
    0xe6,0xf0,0x55,0x14,0xd5,0x34,0x2,0x15,
    0x5,0xa2,0xde,0xf0,0x65,0x70,0x1,0xa2,
    0xde,0xf0,0x55,0x15,0xf,0xa2,0xe3,0xf0,
    0x65,0x70,0x1,0xa2,0xe3,0xf0,0x55,0x26,
    0x51,0x13,0x3,0x0,0xee,0x6c,0x19,0x6d,
    0x1,0x65,0xf,0xa2,0x29,0x60,0x4,0xdc,
    0xdf,0x7c,0x8,0xf5,0x1e,0x70,0xff,0x30,
    0x0,0x15,0x1f,0x6c,0x19,0x6d,0x10,0x60,
    0x5,0xdc,0xdf,0x7c,0x8,0xf5,0x1e,0x70,
    0xff,0x30,0x0,0x15,0x31,0x60,0x1e,0xf0,
    0x15,0xf0,0x7,0x30,0x0,0x15,0x41,0x6c,
    0x1,0x6d,0x4,0x65,0x7,0xa2,0xb0,0x60,
    0x2,0xdc,0xd7,0x7c,0x7,0xf5,0x1e,0x70,
    0xff,0x30,0x0,0x15,0x51,0x6c,0x5,0x6d,
    0xd,0x60,0x32,0xf0,0x15,0xf0,0x7,0x30,
    0x0,0x15,0x65,0x60,0x2,0xdc,0xd7,0x7c,
    0x8,0xf5,0x1e,0x70,0xff,0x30,0x0,0x15,
    0x6d,0x60,0x32,0xf0,0x15,0xf0,0x7,0x30,
    0x0,0x15,0x7d,0x60,0xa,0xf0,0x18,0xdc,
    0xd7,0x60,0xc8,0xf0,0x15,0xf0,0x7,0x30,
    0x0,0x15,0x8d,0x0,0xee,0x6c,0x0,0xc4,
    0xb4,0xc5,0xa,0x75,0x6,0xc6,0x4,0x76,
    0x1,0x88,0xc0,0x88,0x44,0x81,0x80,0x83,
    0x60,0x62,0x0,0x6d,0x0,0x43,0x0,0x15,
    0xc9,0x82,0x14,0x4f,0x1,0x72,0x4c,0x73,
    0xff,0x6e,0xb4,0x8e,0x27,0x3f,0x1,0x15,
    0xc7,0x60,0xb4,0x82,0x5,0x15,0xb9,0x15,
    0xad,0x6e,0x5a,0x8e,0x25,0x4f,0x1,0x15,
    0xd5,0x60,0xb4,0x82,0x7,0x80,0x26,0x80,
    0x6,0xa2,0xea,0xf0,0x1e,0xf0,0x65,0x62,
    0x0,0x83,0x50,0x82,0x4,0x8d,0xf4,0x73,
    0xff,0x43,0x0,0x15,0xef,0x15,0xe3,0x60,
    0x20,0x80,0x55,0x8d,0x4,0xa2,0x2,0xdc,
    0xd1,0x7d,0x1,0x6e,0x20,0x8e,0xd7,0x4f,
    0x1,0x16,0x5,0x15,0xf7,0x7c,0x1,0x6e,
    0x40,0x8e,0xc7,0x4f,0x1,0x16,0x11,0x15,
    0xa1,0xa2,0xe7,0x80,0x40,0x81,0x60,0x82,
    0x50,0xf2,0x55,0x0,0xee,0xa2,0x11,0x7c,
    0xfc,0x7d,0xfb,0xdc,0xd8,0x60,0x5,0xf0,
    0x15,0xf0,0x7,0x30,0x0,0x16,0x29,0x34,
    0x3,0x16,0x39,0xa2,0x11,0xdc,0xd8,0x16,
    0x4f,0x60,0xa,0xf0,0x18,0xa2,0x19,0xdc,
    0xd8,0x60,0x5,0xf0,0x15,0xf0,0x7,0x30,
    0x0,0x16,0x45,0xa2,0x21,0xdc,0xd8,0x0,
    0xee,0x0,0xe0,0x6c,0xc,0x6d,0x6,0xa2,
    0xde,0xf0,0x65,0x83,0x0,0xa2,0xd9,0xf3,
    0x33,0xa2,0xd9,0xf2,0x65,0xf0,0x29,0xdc,
    0xd5,0x7c,0x5,0xf1,0x29,0xdc,0xd5,0x7c,
    0x5,0xf2,0x29,0xdc,0xd5,0x7c,0x10,0xa2,
    0xe3,0xf0,0x65,0x83,0x0,0xa2,0xd9,0xf3,
    0x33,0xa2,0xd9,0xf2,0x65,0xf0,0x29,0xdc,
    0xd5,0x7c,0x5,0xf1,0x29,0xdc,0xd5,0x7c,
    0x5,0xf2,0x29,0xdc,0xd5,0x6c,0xe,0x6d,
    0x12,0xa2,0x5,0xdc,0xd6,0x6c,0x29,0xa2,
    0xb,0xdc,0xd6,0x60,0xc8,0xf0,0x15,0xf0,
    0x7,0x30,0x0,0x16,0xa7,0x0,0xee,0x61,
    0x1,0x80,0x12,0xa2,0xdc,0x40,0x0,0xa2,
    0xe1,0xf4,0x65,0x87,0x30,0x86,0x40,0xa2,
    0x3,0x70,0xff,0x71,0xf8,0xd0,0x12,0x27,
    0x9f,0x60,0x5,0xe0,0xa1,0x76,0x1,0x60,
    0x8,0xe0,0xa1,0x76,0xff,0x60,0x7,0xe0,
    0xa1,0x77,0x1,0x60,0x9,0xe0,0xa1,0x77,
    0xff,0x47,0xb5,0x67,0x0,0x47,0xff,0x67,
    0xb4,0x46,0x65,0x66,0x1,0x46,0x0,0x66,
    0x64,0x60,0xe,0xe0,0xa1,0x17,0x5,0xf0,
    0x7,0x30,0x0,0x16,0xf7,0x27,0xcf,0x60,
    0x3,0xf0,0x15,0x16,0xc9,0x27,0x9f,0xa2,
    0xe6,0xf0,0x65,0x61,0x1,0x80,0x12,0x8a,
    0x0,0xa2,0xdc,0x40,0x0,0xa2,0xe1,0x60,
    0x3,0xf0,0x1e,0x80,0x70,0x81,0x60,0xf1,
    0x55,0x68,0x0,0x69,0x0,0x6e,0x5a,0x8e,
    0x75,0x4f,0x1,0x17,0x35,0x60,0xb4,0x87,
    0x7,0x61,0x1,0x17,0x37,0x61,0x0,0x80,
    0x76,0x80,0x6,0xa2,0xea,0xf0,0x1e,0xf0,
    0x65,0x62,0x0,0x83,0x60,0x82,0x4,0x89,
    0xf4,0x73,0xff,0x43,0x0,0x17,0x51,0x17,
    0x45,0x80,0x76,0x80,0x6,0xa2,0xea,0x62,
    0x16,0x82,0x5,0xf2,0x1e,0xf0,0x65,0x62,
    0x0,0x83,0x60,0x82,0x4,0x88,0xf4,0x73,
    0xff,0x43,0x0,0x17,0x6f,0x17,0x63,0x31,
    0x1,0x17,0x79,0x80,0x80,0x68,0x0,0x88,
    0x5,0x3a,0x1,0x17,0x85,0xa2,0xdc,0x64,
    0x4,0x65,0xfc,0x17,0x8b,0xa2,0xe1,0x64,
    0xfb,0x65,0xfc,0xf1,0x65,0x8c,0x0,0x8d,
    0x10,0x8c,0x44,0x8d,0x54,0xa2,0x3,0x70,
    0xff,0x71,0xf8,0xd0,0x12,0x0,0xee,0x6c,
    0xf,0x6d,0x1,0xa2,0xd6,0xf2,0x65,0xf0,
    0x29,0xdc,0xd5,0x7c,0x5,0xf1,0x29,0xdc,
    0xd5,0x7c,0x5,0xf2,0x29,0xdc,0xd5,0x7c,
    0xa,0xa2,0xd3,0xf2,0x65,0xf0,0x29,0xdc,
    0xd5,0x7c,0x5,0xf1,0x29,0xdc,0xd5,0x7c,
    0x5,0xf2,0x29,0xdc,0xd5,0x0,0xee,0x6c,
    0xf,0x6d,0x1,0xa2,0xd6,0xf2,0x65,0x83,
    0x0,0x84,0x10,0x85,0x20,0xa2,0xd6,0xf7,
    0x33,0xa2,0xd6,0xf2,0x65,0xf3,0x29,0xdc,
    0xd5,0xf0,0x29,0xdc,0xd5,0x7c,0x5,0xf4,
    0x29,0xdc,0xd5,0xf1,0x29,0xdc,0xd5,0x7c,
    0x5,0xf5,0x29,0xdc,0xd5,0xf2,0x29,0xdc,
    0xd5,0x7c,0xa,0xa2,0xd3,0xf2,0x65,0x83,
    0x0,0x84,0x10,0x85,0x20,0xa2,0xd3,0xf6,
    0x33,0xa2,0xd3,0xf2,0x65,0xf3,0x29,0xdc,
    0xd5,0xf0,0x29,0xdc,0xd5,0x7c,0x5,0xf4,
    0x29,0xdc,0xd5,0xf1,0x29,0xdc,0xd5,0x7c,
    0x5,0xf5,0x29,0xdc,0xd5,0xf2,0x29,0xdc,
    0xd5,0x0,0xee,0x66,0x0,0x67,0x0,0x6b,
    0x0,0x65,0x0,0x80,0x8e,0x4f,0x0,0x18,
    0x53,0x61,0xff,0x80,0x13,0x86,0x5,0x3f,
    0x0,0x18,0x51,0x60,0x1,0x8c,0x5,0x65,
    0x1,0x18,0x5d,0x86,0x4,0x3f,0x1,0x18,
    0x5d,0x7c,0x1,0x65,0x1,0x80,0x9e,0x4f,
    0x0,0x18,0x75,0x61,0xff,0x80,0x13,0x87,
    0x5,0x3f,0x0,0x18,0x73,0x60,0xff,0x8d,
    0x5,0x65,0x1,0x18,0x7f,0x87,0x4,0x3f,
    0x1,0x18,0x7f,0x7d,0xff,0x65,0x1,0x4c,
    0xff,0x6c,0x3f,0x4c,0x40,0x6c,0x0,0x6e,
    0x20,0x8e,0xd7,0x4f,0x1,0x65,0x0,0x6e,
    0x7,0x8e,0xd7,0x4f,0x1,0x18,0xb7,0x6e,
    0xe,0x8e,0xc7,0x3f,0x1,0x18,0xb7,0x6e,
    0x32,0x8e,0xc7,0x4f,0x1,0x18,0xb7,0x6e,
    0x21,0x8e,0xc5,0x3f,0x1,0x65,0x0,0x6e,
    0x1e,0x8e,0xc7,0x3f,0x1,0x65,0x0,0x6f,
    0x0,0x45,0x0,0x18,0xc1,0xa2,0x2,0xdc,
    0xd1,0x28,0xdd,0x34,0x0,0x18,0xdb,0x60,
    0x80,0x8b,0x4,0x3f,0x0,0x79,0xff,0xf0,
    0x7,0x30,0x0,0x18,0xcf,0x60,0x1,0xf0,
    0x15,0x18,0x39,0x0,0xee,0x80,0xf0,0x64,
    0x3,0x4d,0x1f,0x0,0xee,0x30,0x0,0x18,
    0xed,0x64,0x0,0x0,0xee,0xa2,0xdc,0xf1,
    0x65,0x80,0xc5,0x3f,0x0,0x19,0x1,0x62,
    0x3,0x80,0x24,0x3f,0x0,0x64,0x1,0x19,
    0x9,0x6e,0x3,0x8e,0x5,0x4f,0x1,0x64,
    0x1,0x34,0x1,0x19,0x25,0x81,0xd5,0x3f,
    0x0,0x19,0x1d,0x62,0x2,0x81,0x24,0x3f,
    0x0,0x0,0xee,0x19,0x25,0x6e,0x2,0x8e,
    0x15,0x4f,0x1,0x0,0xee,0xa2,0xe1,0xf1,
    0x65,0x80,0xc5,0x3f,0x0,0x19,0x39,0x62,
    0x3,0x80,0x24,0x3f,0x0,0x64,0x2,0x19,
    0x41,0x6e,0x3,0x8e,0x5,0x4f,0x1,0x64,
    0x2,0x34,0x2,0x19,0x5d,0x81,0xd5,0x3f,
    0x0,0x19,0x55,0x62,0x2,0x81,0x24,0x3f,
    0x0,0x0,0xee,0x19,0x5d,0x6e,0x2,0x8e,
    0x15,0x4f,0x1,0x0,0xee,0xa2,0xe7,0xf2,
    0x65,0x84,0x20,0x8e,0x10,0x83,0xc0,0x83,
    0x4,0x81,0x30,0x83,0xe0,0x62,0x0,0x6a,
    0x0,0x43,0x0,0x19,0x8d,0x82,0x14,0x4f,
    0x1,0x72,0x4c,0x73,0xff,0x6e,0xb4,0x8e,
    0x27,0x3f,0x1,0x19,0x8b,0x60,0xb4,0x82,
    0x5,0x19,0x7d,0x19,0x71,0x6e,0x5a,0x8e,
    0x25,0x4f,0x1,0x19,0x99,0x60,0xb4,0x82,
    0x7,0x80,0x26,0x80,0x6,0xa2,0xea,0xf0,
    0x1e,0xf0,0x65,0x62,0x0,0x83,0x40,0x82,
    0x4,0x8a,0xf4,0x73,0xff,0x43,0x0,0x19,
    0xb3,0x19,0xa7,0x60,0x20,0x80,0x45,0x8a,
    0x4,0x8e,0xd0,0x8e,0xa7,0x4f,0x1,0x19,
    0xc5,0x64,0x3,0x0,0xee,0x64,0x0,0x0,
    0xee
})

function ctx.timers_tick()
    if ctx.ST > 0 then ctx.ST = ctx.ST - 1 end
    if ctx.DT > 0 then ctx.DT = ctx.DT - 1 end
end

function ctx.tick()
    local op = program[ctx.PC]
    ctx.PC = ctx.PC + 2
    if op then op() end
end
return ctx
